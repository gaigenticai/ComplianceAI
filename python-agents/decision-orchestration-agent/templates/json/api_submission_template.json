{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://eba.europa.eu/schemas/api/submission/v1.0",
  "title": "EBA API Submission Template",
  "description": "Standardized JSON template for EBA API submissions with comprehensive validation",
  "type": "object",
  "required": [
    "submissionMetadata",
    "institutionIdentification",
    "reportData",
    "validationResults",
    "submissionAttestation"
  ],
  "properties": {
    "submissionMetadata": {
      "type": "object",
      "description": "Submission metadata and tracking information",
      "required": ["submissionId", "reportType", "reportingPeriod", "submissionTimestamp"],
      "properties": {
        "submissionId": {
          "type": "string",
          "pattern": "^SUB-[A-Z0-9]{20}-[0-9]{14}$",
          "description": "Unique submission identifier",
          "example": "SUB-TESTBANK001234567890-20240430235959"
        },
        "reportType": {
          "type": "string",
          "enum": ["FINREP", "COREP", "DORA", "AML", "LIQUIDITY", "LEVERAGE", "MREL", "PILLAR3"],
          "description": "Type of regulatory report",
          "example": "FINREP"
        },
        "reportingPeriod": {
          "type": "string",
          "pattern": "^[0-9]{4}-(Q[1-4]|M(0[1-9]|1[0-2]))$",
          "description": "Reporting period (YYYY-QN or YYYY-MNN)",
          "example": "2024-Q1"
        },
        "submissionTimestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Submission timestamp in UTC",
          "example": "2024-04-30T23:59:59Z"
        },
        "submissionDeadline": {
          "type": "string",
          "format": "date-time",
          "description": "Regulatory submission deadline",
          "example": "2024-04-30T23:59:59Z"
        },
        "submissionVersion": {
          "type": "string",
          "pattern": "^v[0-9]+\\.[0-9]+$",
          "description": "Submission version",
          "example": "v1.0"
        },
        "resubmission": {
          "type": "boolean",
          "description": "Indicates if this is a resubmission",
          "example": false
        },
        "originalSubmissionId": {
          "type": "string",
          "description": "Original submission ID if this is a resubmission",
          "example": "SUB-TESTBANK001234567890-20240430120000"
        },
        "submissionReason": {
          "type": "string",
          "enum": ["REGULAR", "CORRECTION", "REVISION", "SUPPLEMENTARY"],
          "description": "Reason for submission",
          "example": "REGULAR"
        }
      }
    },
    "institutionIdentification": {
      "type": "object",
      "description": "Institution identification and contact information",
      "required": ["lei", "institutionName", "competentAuthority"],
      "properties": {
        "lei": {
          "type": "string",
          "pattern": "^[A-Z0-9]{18}[0-9]{2}$",
          "description": "Legal Entity Identifier (LEI)",
          "example": "TESTBANK001234567890"
        },
        "institutionName": {
          "type": "string",
          "maxLength": 200,
          "description": "Official institution name",
          "example": "Test Bank AG"
        },
        "institutionCode": {
          "type": "string",
          "maxLength": 50,
          "description": "Institution code assigned by competent authority",
          "example": "TESTBANK001"
        },
        "competentAuthority": {
          "type": "string",
          "enum": ["ECB", "BAFIN", "ACPR", "BOI", "DNB", "FCA", "CNMV", "CONSOB", "FMA", "OTHER"],
          "description": "Competent supervisory authority",
          "example": "BAFIN"
        },
        "jurisdiction": {
          "type": "string",
          "pattern": "^[A-Z]{2}$",
          "description": "Primary jurisdiction (ISO 3166-1 alpha-2)",
          "example": "DE"
        },
        "consolidationBasis": {
          "type": "string",
          "enum": ["INDIVIDUAL", "CONSOLIDATED"],
          "description": "Reporting basis",
          "example": "CONSOLIDATED"
        },
        "contactInformation": {
          "type": "object",
          "properties": {
            "contactPerson": {
              "type": "string",
              "description": "Primary contact person name",
              "example": "John Doe"
            },
            "contactEmail": {
              "type": "string",
              "format": "email",
              "description": "Contact email address",
              "example": "john.doe@testbank.com"
            },
            "contactPhone": {
              "type": "string",
              "pattern": "^\\+[1-9]\\d{1,14}$",
              "description": "Contact phone number (E.164 format)",
              "example": "+49301234567"
            }
          }
        }
      }
    },
    "reportData": {
      "type": "object",
      "description": "Report data payload",
      "required": ["dataFormat", "dataPayload"],
      "properties": {
        "dataFormat": {
          "type": "string",
          "enum": ["XBRL", "CSV", "JSON", "XML"],
          "description": "Format of the report data",
          "example": "XBRL"
        },
        "dataPayload": {
          "oneOf": [
            {
              "type": "string",
              "description": "Base64 encoded data for binary formats (XBRL, CSV)"
            },
            {
              "type": "object",
              "description": "JSON object for JSON format reports"
            }
          ]
        },
        "dataSize": {
          "type": "integer",
          "minimum": 0,
          "description": "Size of data payload in bytes",
          "example": 1048576
        },
        "dataChecksum": {
          "type": "string",
          "pattern": "^[a-f0-9]{64}$",
          "description": "SHA-256 checksum of data payload",
          "example": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
        },
        "compressionUsed": {
          "type": "boolean",
          "description": "Indicates if data is compressed",
          "example": true
        },
        "compressionAlgorithm": {
          "type": "string",
          "enum": ["GZIP", "ZIP", "NONE"],
          "description": "Compression algorithm used",
          "example": "GZIP"
        },
        "encryptionUsed": {
          "type": "boolean",
          "description": "Indicates if data is encrypted",
          "example": true
        },
        "encryptionAlgorithm": {
          "type": "string",
          "enum": ["AES-256-GCM", "AES-256-CBC", "NONE"],
          "description": "Encryption algorithm used",
          "example": "AES-256-GCM"
        }
      }
    },
    "validationResults": {
      "type": "object",
      "description": "Data validation results and quality metrics",
      "required": ["validationStatus", "validationTimestamp"],
      "properties": {
        "validationStatus": {
          "type": "string",
          "enum": ["PASSED", "PASSED_WITH_WARNINGS", "FAILED"],
          "description": "Overall validation status",
          "example": "PASSED"
        },
        "validationTimestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Validation completion timestamp",
          "example": "2024-04-30T22:30:00Z"
        },
        "validationEngine": {
          "type": "string",
          "description": "Validation engine used",
          "example": "ComplianceAI-Validator-v4.0"
        },
        "dataQualityScore": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Overall data quality score (0-100)",
          "example": 95.5
        },
        "validationRules": {
          "type": "array",
          "description": "Validation rules applied",
          "items": {
            "type": "object",
            "required": ["ruleId", "ruleName", "status"],
            "properties": {
              "ruleId": {
                "type": "string",
                "description": "Unique rule identifier",
                "example": "FINREP_F02_01_BALANCE_CHECK"
              },
              "ruleName": {
                "type": "string",
                "description": "Human-readable rule name",
                "example": "Balance Sheet Balance Check"
              },
              "ruleType": {
                "type": "string",
                "enum": ["MANDATORY", "CONDITIONAL", "BUSINESS", "TECHNICAL", "TAXONOMY"],
                "description": "Type of validation rule",
                "example": "BUSINESS"
              },
              "status": {
                "type": "string",
                "enum": ["PASSED", "WARNING", "ERROR"],
                "description": "Rule validation status",
                "example": "PASSED"
              },
              "message": {
                "type": "string",
                "description": "Validation message or error description",
                "example": "Total assets equals total liabilities plus equity"
              },
              "severity": {
                "type": "string",
                "enum": ["INFO", "LOW", "MEDIUM", "HIGH", "CRITICAL"],
                "description": "Issue severity level",
                "example": "INFO"
              }
            }
          }
        },
        "errorSummary": {
          "type": "object",
          "properties": {
            "totalErrors": {
              "type": "integer",
              "minimum": 0,
              "description": "Total number of errors",
              "example": 0
            },
            "totalWarnings": {
              "type": "integer",
              "minimum": 0,
              "description": "Total number of warnings",
              "example": 2
            },
            "criticalErrors": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of critical errors",
              "example": 0
            },
            "businessRuleViolations": {
              "type": "integer",
              "minimum": 0,
              "description": "Number of business rule violations",
              "example": 0
            }
          }
        }
      }
    },
    "submissionAttestation": {
      "type": "object",
      "description": "Submission attestation and authorization",
      "required": ["attestationProvided", "attestationTimestamp"],
      "properties": {
        "attestationProvided": {
          "type": "boolean",
          "description": "Management attestation provided",
          "example": true
        },
        "attestationTimestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Attestation timestamp",
          "example": "2024-04-30T23:45:00Z"
        },
        "attestingOfficer": {
          "type": "object",
          "properties": {
            "name": {
              "type": "string",
              "description": "Name of attesting officer",
              "example": "Jane Smith"
            },
            "title": {
              "type": "string",
              "description": "Title/position of attesting officer",
              "example": "Chief Financial Officer"
            },
            "email": {
              "type": "string",
              "format": "email",
              "description": "Email of attesting officer",
              "example": "jane.smith@testbank.com"
            }
          }
        },
        "attestationStatement": {
          "type": "string",
          "description": "Attestation statement text",
          "example": "I hereby attest that the information contained in this submission is true, complete, and accurate to the best of my knowledge."
        },
        "digitalSignature": {
          "type": "object",
          "description": "Digital signature for attestation",
          "properties": {
            "signatureAlgorithm": {
              "type": "string",
              "enum": ["RSA-PSS-SHA256", "ECDSA-SHA256"],
              "description": "Digital signature algorithm",
              "example": "RSA-PSS-SHA256"
            },
            "signatureValue": {
              "type": "string",
              "description": "Base64 encoded signature value",
              "example": "MEUCIQDxyz123..."
            },
            "certificateChain": {
              "type": "array",
              "items": {"type": "string"},
              "description": "X.509 certificate chain (Base64 encoded)",
              "example": ["MIIDxyz123...", "MIIEabc456..."]
            },
            "signingTimestamp": {
              "type": "string",
              "format": "date-time",
              "description": "Signing timestamp",
              "example": "2024-04-30T23:45:00Z"
            }
          }
        }
      }
    },
    "technicalMetadata": {
      "type": "object",
      "description": "Technical metadata for submission processing",
      "properties": {
        "submissionSource": {
          "type": "string",
          "description": "Source system that generated the submission",
          "example": "ComplianceAI-ReportGenerator-v4.0"
        },
        "apiVersion": {
          "type": "string",
          "pattern": "^v[0-9]+\\.[0-9]+$",
          "description": "EBA API version used",
          "example": "v2.1"
        },
        "clientVersion": {
          "type": "string",
          "description": "Client software version",
          "example": "ComplianceAI-Client-v4.0"
        },
        "submissionEnvironment": {
          "type": "string",
          "enum": ["PRODUCTION", "SANDBOX", "TEST"],
          "description": "Submission environment",
          "example": "PRODUCTION"
        },
        "correlationId": {
          "type": "string",
          "description": "Correlation ID for tracking",
          "example": "corr-12345678-abcd-efgh-ijkl-123456789012"
        },
        "retryAttempt": {
          "type": "integer",
          "minimum": 0,
          "description": "Retry attempt number (0 for first attempt)",
          "example": 0
        },
        "processingPriority": {
          "type": "string",
          "enum": ["LOW", "NORMAL", "HIGH", "URGENT"],
          "description": "Processing priority",
          "example": "NORMAL"
        }
      }
    },
    "auditTrail": {
      "type": "object",
      "description": "Audit trail for submission lifecycle",
      "properties": {
        "events": {
          "type": "array",
          "description": "Chronological list of audit events",
          "items": {
            "type": "object",
            "required": ["eventId", "eventType", "timestamp"],
            "properties": {
              "eventId": {
                "type": "string",
                "description": "Unique event identifier",
                "example": "evt-12345678-abcd-efgh-ijkl-123456789012"
              },
              "eventType": {
                "type": "string",
                "enum": ["DATA_EXTRACTION", "DATA_VALIDATION", "REPORT_GENERATION", "SUBMISSION_CREATED", "SUBMISSION_SENT", "ACKNOWLEDGMENT_RECEIVED", "PROCESSING_COMPLETED", "ERROR_OCCURRED"],
                "description": "Type of audit event",
                "example": "SUBMISSION_CREATED"
              },
              "timestamp": {
                "type": "string",
                "format": "date-time",
                "description": "Event timestamp",
                "example": "2024-04-30T23:30:00Z"
              },
              "userId": {
                "type": "string",
                "description": "User or system that triggered the event",
                "example": "system.automated"
              },
              "description": {
                "type": "string",
                "description": "Event description",
                "example": "Submission successfully created and validated"
              },
              "metadata": {
                "type": "object",
                "description": "Additional event metadata",
                "additionalProperties": true
              }
            }
          }
        },
        "integrityHash": {
          "type": "string",
          "pattern": "^[a-f0-9]{64}$",
          "description": "SHA-256 hash of audit trail for integrity verification",
          "example": "a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456"
        }
      }
    }
  },
  "additionalProperties": false
}
